- role = current_role(current_user, request.url)

.container
  = render 'shared/broadcasts/toolbar'

.container
  .row
    .col-xs-12
      .row
        - broadcasts.first(2).each do |object|
          - if role
            - like_path = url_for([:like, role, object])
            - dislike_path = url_for([:dislike, role, object])
          - else
            - like_path = nil
            - dislike_path = nil

          - question = Question.where(questionable: object).first
          - cover = image_default_path(object.cover, "movie")

          .col-xs-6
            .row
              .col-xs-4{ id: object.id, style: 'padding-right: 0px;' }
                / %img.img-responsive{ src: cover, style: 'height: 300px; width: 200px;' }
                = image_tag(cover, class: "img-responsive", style: 'height: 300px; width: 200px;')
              .col-xs-8
                .row
                  .col-xs-12{ style: 'height: 275px;' }
                    %h3.bold{ style: 'box-sizing: border-box; color: rgb(51, 51, 51); font-family: "Montserrat"; font-size: 20px; font-weight: 700; line-height: 26.4px; margin-bottom: 0px; margin-top: 0px; min-height: 25px; max-height: 50px' }
                      = object.title
                    .wine{ style: 'height: 20px; margin-bottom: 10px;' }
                      = object.spoiler_str
                    .desc{ style: 'min-height: 168px; max-height: 190px; overflow: hidden; font-size: 13px; ' }
                      = object.content.html_safe

                      - unless object.video.blank?
                        %span.more.wine{ data: { show: '', url: polymorphic_path([object], view: 'video') }, style: 'cursor: pointer;' }
                          \.
                          Assista ao vídeo
                      - if object.broadcast_images.any?
                        %span.more.wine{ data: { show: '', url: polymorphic_path([object], view: 'gallery') }, style: 'cursor: pointer;' }
                          \.
                          Veja a galeria
                      - unless object.more.blank?
                        %span.more.wine{ data: { show: '', url: polymorphic_path([object], view: 'info') }, style: 'cursor: pointer;' }
                          \.
                          Informações completas aqui

                    .pull-left{ style: 'padding-left: 0px;'}
                      .source.bold{ style: 'height: 20px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; font-size: 12px;' }
                        Fonte:
                        = object.source
                    .pull-right
                      %span.bold.wine{ style: 'float: right; font-size: 12px;' }
                        = link_to object.date_str, polymorphic_path([role, :broadcasts], filter: { date: object.date_str })
                    .row{ style: 'margin-top: 38px;' }
                      .col-xs-4
                        .row{ style: 'margin-left: -10px; height: 25px; margin-top: 15px;' }
                          .broadcast-reaction
                            = render 'shared/reactions', resource: object, like_path: like_path, dislike_path: dislike_path
                      .col-xs-4{ style: 'line-height: 35px; padding-left: 0px' }
                        .fb-share-button{"data-href" => "https://developers.facebook.com/docs/plugins/", "data-layout" => "button_count", "data-mobile-iframe" => "true", "data-size" => "small"}
                          %a.fb-xfbml-parse-ignore{:href => "https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&src=sdkpreparse", :target => "_blank"} Compartilhar
                      .col-xs-4{ style: 'padding-left: 0px;' }
                        - if current_user
                          - if !question.blank?
                            = link_to polymorphic_path([role, question]) do
                              %button.btn.btn-login
                                Debater
                                %span.icon.icon-button
                          - else
                            = link_to polymorphic_path([:new, role, :question], questionable_type: 'Broadcast', questionable_id: object.id) do
                              %button.btn.btn-login
                                Debater
                                %span.icon.icon-button

.container.noticias
  .row
    .col-xs-12
      - broadcasts.each_with_index do |object, index|
        - if index > 1
          - if role
            - like_path = url_for([:like, role, object])
            - dislike_path = url_for([:dislike, role, object])
          - else
            - like_path = nil
            - dislike_path = nil
          - question = Question.where(questionable: object).first
          - cover = image_default_path(object.cover, "movie")

          .noticia-item
            .row
              .col-xs-3{ id: object.id }
                / %img.img-responsive{ src: cover, style: 'height: 171px; width: 261px;' }
                = image_tag(cover, class: "img-responsive", style: 'height: 171px; width: 261px;')
              .col-xs-9
                %h3.bold{ style: 'box-sizing: border-box; color: rgb(51, 51, 51); font-family: "Montserrat"; font-size: 20px; font-weight: 700; line-height: 26.4px; margin-bottom: 0px; margin-top: 0px; height: 25px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;' }
                  = object.title
                .wine{ style: 'height: 20px;' }
                  = object.spoiler_str
                .desc{ style: 'min-height: 90px; max-height: 113px; overflow: hidden; font-size: 13px;' }
                  = object.content.html_safe

                  - unless object.video.blank?
                    %span.more.wine{ data: { show: '', url: polymorphic_path([object], view: 'video') }, style: 'cursor: pointer;' }
                      \.
                      Assista ao vídeo
                  - if object.broadcast_images.any?
                    %span.more.wine{ data: { show: '', url: polymorphic_path([object], view: 'gallery') }, style: 'cursor: pointer;' }
                      \.
                      Veja a galeria
                  - unless object.more.blank?
                    %span.more.wine{ data: { show: '', url: polymorphic_path([object], view: 'info') }, style: 'cursor: pointer;' }
                      \.
                      Informações completas aqui

                .pull-left{ style: 'padding-left: 0px;'}
                  .source.bold{ style: 'height: 20px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; font-size: 12px;' }
                    Fonte:
                    = object.source
                .pull-right
                  %span.bold.wine{ style: 'float: right; font-size: 12px;' }
                    = link_to object.date_str, polymorphic_path([role, :broadcasts], filter: { date: object.date_str })
                .row{ style: 'margin-top: 20px;' }
                  .col-xs-4
                    .row{ style: 'margin-left: -10px; height: 25px; margin-top: 15px;' }
                      .broadcast-reaction
                        = render 'shared/reactions', resource: object, like_path: like_path, dislike_path: dislike_path
                  .col-xs-offset-4.col-xs-2{ style: 'line-height: 35px' }
                    .fb-share-button{"data-href" => "https://developers.facebook.com/docs/plugins/", "data-layout" => "button_count", "data-mobile-iframe" => "true", "data-size" => "small"}
                      %a.fb-xfbml-parse-ignore{:href => "https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&src=sdkpreparse", :target => "_blank"} Compartilhar
                  .col-xs-2
                    - if current_user
                      - if !question.blank?
                        = link_to polymorphic_path([role, question]) do
                          %button.btn.btn-login
                            Debater
                            %span.icon.icon-button
                      - else
                        = link_to polymorphic_path([:new, role, :question], questionable_type: 'Broadcast', questionable_id: object.id) do
                          %button.btn.btn-login
                            Debater
                            %span.icon.icon-button

#broadcastModal.modal.fade{:role => "dialog"}
  .modal-dialog
